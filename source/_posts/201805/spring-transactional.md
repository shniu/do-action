---
title: spring 事务处理
p: 201805/spring-transactional
date: 2018-05-13 21:31:28
tags:
  - spring
---

## Spring 事务处理

#### 事务的作用

将若干的数据库操作作为一个整体控制,一起成功或一起失败。

- 原子性：指事务是一个不可分割的工作单位，事务中的操作要么都发生，要么都不发生。
- 一致性：指事务前后数据的完整性必须保持一致。
- 隔离性：指多个用户并发访问数据库时，一个用户的事务不能被其他用户的事务所干扰，多个并发事务之间数据要相互隔离。
-  持久性：指一个事务一旦被提交，它对数据库中数据的改变就是永久性的，即时数据库发生故障也不应该对其有任何影响。

#### 容易引发的问题

- 脏读：一个事务读取了另一个事务改写但还未提交的数据，如果这些数据被回滚，则读到的数据是无效的。
- 不可重复读：在同一事务中，多次读取同一数据返回的结果有所不同。
- 幻读：一个事务读取了几行记录后，另一个事务插入一些记录，幻读就发生了。再后来的查询中，第一个事务就会发现有些原来没有的记录。

#### 事务隔离级别

- DEFAULT--使用后端数据库默认的隔离级别（Spring中的选择项）
- READ_UNCOMMITED--允许你读取还未提交的改变了的数据。可能导致脏、幻、不可重复读
- READ_COMMITTED--允许在并发事务已经提交后读取。可防止脏读，但幻读和不可重复读仍可发生
- REPEATABLE_READ--对相同字段的多次读取是一致的，除非数据被事务本身改变。可防止脏、不可重复读，但幻读仍可能发生
- SERIALIZABLE--完全服从ACID的隔离级别，确保不发生脏、幻、不可重复读。这在所有的隔离级别中是最慢的，它是典型的通过完全锁定在事务中涉及的数据表来完成的


